<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
    <meta name="apple-mobile-web-app-capable" content="yes"/>
    <meta name="apple-mobile-web-app-status-bar-style" content="black"/>
    <meta name="format-detection" content="telephone=no, email=no"/>
    <title>转盘抽奖</title>
    <!-- build:css styles/skin2.css -->
    <link rel="stylesheet" href="components/lottery-turntable/lottery-turntable.css">
    <!-- endbuild -->	
</head>
<body>
<div class="wrapper" id="demo">
    <div is="lottery-turntable" :awards="awards" :width="width" :height="height" :chance="chance">转盘抽奖</div>
</div>
<!-- component template -->
<script type="text/x-template" id="html-lottery-turntable">
    <table class="oppo-lottery" cellspacing="5" width="{{width}}" height="{{height}}">
        <colgroup><col width="33%" /><col width="33%" /><col width="33%" /></colgroup>
        <tr><td class="cell" :style="initAward(awards[0])['style']" :class="{'active': 0 == currentIdx}">{{initAward(awards[0])['name']}}</td><td class="cell" :style="initAward(awards[1])['style']" :class="{'active': 1 == currentIdx}">{{initAward(awards[1])['name']}}</td><td class="cell" :style="initAward(awards[2])['style']" :class="{'active': 2 == currentIdx}">{{initAward(awards[2])['name']}}</td></tr>
        <tr><td class="cell" :style="initAward(awards[7])['style']" :class="{'active': 7 == currentIdx}">{{initAward(awards[7])['name']}}</td><td class="center-cell">
            <button type="button" @click="run()">抽奖x{{maxNum}}</button>
        </td><td class="cell" :style="initAward(awards[3])['style']" :class="{'active': 3 == currentIdx}">{{initAward(awards[3])['name']}}</td></tr>
        <tr><td class="cell" :style="initAward(awards[6])['style']" :class="{'active': 6 == currentIdx}">{{initAward(awards[6])['name']}}</td><td class="cell" :style="initAward(awards[5])['style']" :class="{'active': 5 == currentIdx}">{{initAward(awards[5])['name']}}</td><td class="cell" :style="initAward(awards[4])['style']" :class="{'active': 4 == currentIdx}">{{initAward(awards[4])['name']}}</td></tr>
    </table>
</script>
<script>
    var awardsData = [{"id":0,"title":"","start_time":"","end_time":"","source":[{"ids":"1255","name":"OPPO R9","type":"\u5b9e\u7269","pic":"http:\/\/storepic.oppomobile.com\/uploadFiles\/admin_appstore\/content\/201604\/fe2270492c310f4a196e7d037e697751.png","claim_desc":""},{"ids":"1256","name":"\u5927\u4f17\u70b9\u8bc45\u5143\u5238","type":"\u5361\u5377","pic":"http:\/\/storepic.oppomobile.com\/uploadFiles\/admin_appstore\/content\/201604\/2f741a23561eda25ec5c3604c3d8f227.PNG","claim_desc":"\u5956\u54c1\u4e3a\u5927\u4f17\u70b9\u8bc45\u5143\u4ee3\u91d1\u5238\uff0c\u8bf7\u590d\u5236\u5361\u5bc6\u5230\u5927\u4f17\u70b9\u8bc4APP\u4e2d\u4f7f\u7528\u3002"},{"ids":"1258","name":"Beats\u8033\u673a","type":"\u5b9e\u7269","pic":"http:\/\/storepic.oppomobile.com\/uploadFiles\/admin_appstore\/content\/201604\/25a03a6e5fc88892c630510356780a01.PNG","claim_desc":""},{"ids":"1262","name":"20\u53ef\u8c46","type":"\u53ef\u8c46","pic":"http:\/\/storepic.oppomobile.com\/uploadFiles\/admin_appstore\/content\/201604\/58f06386b88038c4bf29a1c09f037aa7.png","claim_desc":""},{"ids":"1257","name":"\u4eac\u4e1c10\u5143\u5238","type":"\u5361\u5377","pic":"http:\/\/storepic.oppomobile.com\/uploadFiles\/admin_appstore\/content\/201604\/2d24302fc4e9385e5746671c83798781.PNG","claim_desc":"\u5956\u54c1\u4e3a\u4eac\u4e1c10\u5143\u4ee3\u91d1\u5238\u3002\u8bf7\u5230\u4eac\u4e1cAPP\u4e2d\u4f7f\u7528\u3002"},{"ids":"1259","name":"\u5927\u5634\u7334\u7535\u98ce\u6247","type":"\u5b9e\u7269","pic":"http:\/\/storepic.oppomobile.com\/uploadFiles\/admin_appstore\/content\/201604\/24948cdb4d714ad8e416a8eaadcf2286.png","claim_desc":""},{"ids":"1261","name":"5\u53ef\u8c46","type":"\u53ef\u8c46","pic":"http:\/\/storepic.oppomobile.com\/uploadFiles\/admin_appstore\/content\/201604\/28bb2c6827f6550cb2025d465530149c.png","claim_desc":""},{"ids":"1260","name":"\u8c22\u8c22\u53c2\u4e0e","type":"\u4e0d\u4e2d\u5956","pic":"http:\/\/storepic.oppomobile.com\/uploadFiles\/admin_appstore\/content\/201604\/fbc32d6328922a478e2895a814a56dd2.png","claim_desc":""}],"activated":true,"show":true}]; var downloadData = [{"id":0,"title":"","slogan":"","source":[{"ids":"6021","app_name":"\u7f8e\u56e2","version_name":"6.7.1","icon_url":"\/uploadFiles\/PImages\/201604\/06\/bd1082746f59d2e443a16c98a8ae1da7.png","apk_size":"18614","down_num":"150447139","recom_words":"20\u5143\u7ea2\u5305\u9650\u65f6\u62a2\uff0c\u5341\u4e8c\u661f\u5ea7\u90fd\u6709\u4efd\uff01","oneword_desc":"\u5403\u8d27\u805a\u9910\u5927\u672c\u8425\uff0c1\u5143\u5e26\u4f60\u5403\u559d\u73a9\u4e50","avggrade":"4.30","version_id":"10125062","state":0,"create_time":"2016-04-26 15:40:43"}]}];
</script>
    <script src="lib/vue.min.js"></script>
    <script src="components/lottery-turntable/lottery-turntable.js"></script>
    <script type="text/javascript">
        var dealData = function (D) {
            var data;
            D = D || [];
            if (typeof D == 'object' || typeof D == 'array') {
                data = D;
            } else if (typeof D == 'string') {
                data = (0, eval)("(" + D + ")");
            }
            return data;
        };

        window.getCurrentAwards = function (D) {
            var data = dealData(D);

            var arr = [];
            for (var i = 0; i < data.length; i++) {
                if (data[i]['activated'] == true) {//当前激活
                    arr = arr.concat(data[i]['source']);
                }
            }
            return arr;
        };

        var lotteryData = getCurrentAwards(awardsData || []);

        var demo = new Vue({
          el: '#demo',
          data: {
            awards: lotteryData,
            width: 400,
            height: 300,
            chance: 1
          },
          methods: {
            setChance: function (n) {
                this.chance = n;
            }
          }
        });

        demo.setChance(3);
    </script>

</body>
</html>
